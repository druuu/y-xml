!function t(e,n,r){function o(s,i){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!i&&a)return a(s,!0);if(l)return l(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return o(n?n:t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var l="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e){var n,r,o,l,s,i,a={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};if(n={},n.Node=function(){function t(){null==this._xml&&(this._xml={})}return t.prototype._checkForModel=function(){if(null==this._model)throw new Error("You have to put the Y."+this._name+' instance on a shared element before you can use it! E.g. on the y object y.val("my-'+this._name+'",y'+this._name+")")},t.prototype._getModel=function(){return null!=this._xml.parent&&this._model.val("parent",this._xml.parent),this._setModel(this._model),null!=this._dom&&this.getDom(),this._model},t.prototype._setModel=function(t){return this._model=t,this._model.observe(function(t){var e,n,r,o,l,s,i,a,h;for(h=[],s=0,i=t.length;i>s;s++)r=t[s],"parent"===r.name&&"add"!==r.type?(l=r.oldValue,n=null!=(a=l._model.val("children"))?a.val():void 0,null!=n&&r.oldValue!==r.object._model.val("parent")?h.push(function(){var t,r,s;for(s=[],o=t=0,r=n.length;r>t;o=++t){if(e=n[o],e===this){l._model.val("children")["delete"](o);break}s.push(void 0)}return s}.call(this)):h.push(void 0)):h.push(void 0);return h}),delete this._xml},t.prototype._setParent=function(t){if(t instanceof n.Element)return null!=this._model?(this.remove(),this._model.val("parent",t)):this._xml.parent=t;throw new Error("parent must be of type Y.Xml!")},t.prototype.after=function(){var t,e,r,o,l,s,i,a,h,u;if(this._checkForModel(),o=this._model.val("parent"),null==o)throw new Error("This Xml Element must not have siblings! (for it does not have a parent)");for(u=o.getChildren(),l=s=0,a=u.length;a>s&&(t=u[l],t!==this);l=++s);for(r=[],i=0,h=arguments.length;h>i;i++){if(e=arguments[i],e instanceof n.Element)e._setParent(this._model.val("parent"));else if(e.constructor!==String)throw new Error("Y.Xml.after expects instances of YXml.Element or String as a parameter");r.push(e)}return o._model.val("children").insertContents(l+1,r)},t.prototype.before=function(){var t,e,r,o,l,s,i,a,h,u;if(this._checkForModel(),o=this._model.val("parent"),null==o)throw new Error("This Xml Element must not have siblings! (for it does not have a parent)");for(u=o.getChildren(),l=s=0,a=u.length;a>s&&(t=u[l],t!==this);l=++s);for(r=[],i=0,h=arguments.length;h>i;i++){if(e=arguments[i],e instanceof n.Element)e._setParent(this._model.val("parent"));else if(e.constructor!==String)throw new Error("Y.Xml.after expects instances of YXml.Element or String as a parameter");r.push(e)}return o._model.val("children").insertContents(l,r)},t.prototype.remove=function(){var t;return this._checkForModel(),null!=this._model.val("parent")&&(t=this._model["delete"]("parent")),this},t.prototype.getParent=function(){return this._checkForModel(),this._model.val("parent")},t.prototype.getPosition=function(){var t,e,n,r,o,l;if(this._checkForModel(),n=this._model.val("parent"),null!=n){for(l=n._model.val("children").val(),e=r=0,o=l.length;o>r;e=++r)if(t=l[e],t===this)return e;throw new Error("This is not a child of its parent (should not happen in Y.Xml!)")}return null},t}(),n.Text=function(t){function e(t){if(null==t&&(t=""),e.__super__.constructor.call(this),t.constructor===String)this._xml.text=t;else if(t instanceof window.Text)this._dom=t;else if(null!=t)throw new Error("The constructor of Y.Xml.Text expects either String or an Dom Text element!")}return h(e,t),e.prototype._getModel=function(t,n){return null==this._model&&(null!=this._dom&&(this._xml.text=this._dom.textContent),this._model=new n.MapManager(this).execute(),this._model.val("text",this._xml.text),e.__super__._getModel.apply(this,arguments)),this._model},e.prototype._name="Xml.Text",e.prototype.toString=function(){return this._checkForModel(),this._model.val("text")},e.prototype.getDom=function(){var t;return null==this._dom&&(this._dom=new window.Text(this._model.val("text"))),null==this._dom._y_xml&&(t=this,o.call(this),this._dom._y_xml=this,this._model.observe(function(e){var n,r,o,l,s;for(s=[],o=0,l=e.length;l>o;o++)n=e[o],"text"!==n.name||"add"!==n.type&&"update"!==n.type?s.push(void 0):(r=t._model.val("text"),t._dom.data!==r?s.push(t._dom.data=r):s.push(void 0));return s})),this._dom},e.prototype.update=function(){var t;return t=this,t._model.val("text")!==t._dom.data&&t._model.val("text",t._dom.data),void 0},e}(n.Node),n.Element=function(t){function e(t,n){var r,o,l,s,i,a,h,u,m;if(null==n&&(n={}),e.__super__.constructor.call(this),null==t);else if(t.constructor===String){if(i=t,this._xml.children=[],this._xml.tagname=i,n.constructor!==Object)throw new Error("The attributes must be specified as an Object");for(o in n)if(r=n[o],r.constructor!==String)throw new Error("The attributes must be of type String!");if(this._xml.attributes=n,this._xml.classes={},a=this._xml.attributes["class"],delete this._xml.attributes["class"],null!=a)for(m=a.split(" "),l=h=0,u=m.length;u>h;l=++h)s=m[l],l.length>0&&(this._xml.classes[s]=l)}else t instanceof("undefined"!=typeof window&&null!==window?window.Element:void 0)&&(this._dom=t)}return h(e,t),e.prototype._name="Xml.Element",e.prototype._getModel=function(t,r){var o,l,s,i,a,h,u,m,d,_,c,p,f;if(null==this._model){if(null!=this._dom){for(this._xml.tagname=this._dom.tagName.toLowerCase(),this._xml.attributes={},this._xml.classes={},c=this._dom.attributes,a=0,m=c.length;m>a;a++)if(o=c[a],"class"===o.name)for(p=o.value.split(" "),h=0,d=p.length;d>h;h++)l=p[h],this._xml.classes[l]=!0;else this._xml.attributes[o.name]=o.value;for(this._xml.children=[],f=this._dom.childNodes,u=0,_=f.length;_>u;u++)s=f[u],s.nodeType===s.TEXT_NODE?this._xml.children.push(new n.Text(s)):s.nodeType===s.ELEMENT_NODE&&(i=null,i=s.tagName.search(/^(textarea|input)$/gi)>=0?new n.InputElement(s):new n.Element(s),i._setParent(this),this._xml.children.push(i))}this._model=new r.MapManager(this).execute(),this._model.val("attributes",new t.Object(this._xml.attributes)),this._model.val("classes",new t.Object(this._xml.classes)),this._model.val("tagname",this._xml.tagname),this._model.val("children",new t.List(this._xml.children)),null!=this._xml.parent&&this._model.val("parent",this._xml.parent),null!=this._dom&&this.getDom(),e.__super__._getModel.apply(this,arguments)}return this._model},e.prototype.toString=function(){var t,e,n,r,o,l,s,i;this._checkForModel(),r="<"+this._model.val("tagname"),s=this.attr();for(e in s)n=s[e],r+=" "+e+'="'+n+'"';for(r+=">",i=this._model.val("children").val(),o=0,l=i.length;l>o;o++)t=i[o],r+=t.toString();return r+="</"+this._model.val("tagname")+">"},e.prototype.attr=function(t,e){var n,r,o,l,s,i;if(this._checkForModel(),arguments.length>1){if(e.constructor!==String)throw new Error("The attributes must be of type String!");if("class"===t){for(o=e.split(" "),l={},s=0,i=o.length;i>s;s++)r=o[s],l[r]=!0;this._model.val("classes",new this._model.custom_types.Object(l))}else this._model.val("attributes").val(t,e);return this}return arguments.length>0?"class"===t?Object.keys(this._model.val("classes").val()).join(" "):this._model.val("attributes").val(t):(n=this._model.val("attributes").val(),o=Object.keys(this._model.val("classes").val()).join(" "),o.length>0&&(n["class"]=o),n)},e.prototype.addClass=function(t){var e,n,r,o;for(this._checkForModel(),o=t.split(" "),n=0,r=o.length;r>n;n++)e=o[n],this._model.val("classes").val(e,!0);return this},e.prototype.append=function(){var t,e,r;for(this._checkForModel(),e=0,r=arguments.length;r>e;e++){if(t=arguments[e],t.constructor===String&&(t=new n.Text(t)),!(t instanceof n.Node))throw new Error("Y.Xml.after expects instances of YXml.Node (e.g. Element, Text) or String as a parameter");t._setParent(this),this._model.val("children").push(t)}return this},e.prototype.prepend=function(){var t,e,r;for(this._checkForModel(),e=0,r=arguments.length;r>e;e++){if(t=arguments[e],t.constructor===String&&(t=new n.Text(t)),!(t instanceof n.Node))throw new Error("Y.Xml.prepend expects instances of YXml.Node (e.g. Element, Text) or String as a parameter");t._setParent(this),this._model.val("children").insert(0,t)}return this},e.prototype.empty=function(){var t,e,n,r,o,l;for(this._checkForModel(),e=this._model.val("children"),o=e.val(),l=[],n=0,r=o.length;r>n;n++)t=o[n],t.constructor===String?l.push(e["delete"](0)):l.push(t.remove());return l},e.prototype.hasClass=function(t){return this._checkForModel(),null!=this._model.val("classes").val(t)?!0:!1},e.prototype.removeAttr=function(t){return this._checkForModel(),"class"===t?this._model.val("classes",new this._model.custom_types.Object):this._model.val("attributes")["delete"](t),this},e.prototype.removeClass=function(){var t,e,n;if(this._checkForModel(),0===arguments.length)this._model.val("classes",new this._model.custom_types.Object);else for(e=0,n=arguments.length;n>e;e++)t=arguments[e],this._model.val("classes")["delete"](t);return this},e.prototype.toggleClass=function(){var t,e,n,r;for(this._checkForModel(),n=0,r=arguments.length;r>n;n++)t=arguments[n],e=this._model.val("classes"),null!=e.val(t)?e["delete"](t):e.val(t,!0);return this},e.prototype.getChildren=function(){return this._checkForModel(),this._model.val("children").val()},e.prototype.getDom=function(){var t,e,n,l,s,i,a,h,u,m,d,_;if(this._checkForModel(),null==this._dom){a=this._model.val("tagname").search(/^(g|svg|rect|line|path|ellipse|text|tspan|defs|symbol|use|linearGradient|pattern)$/gi),this._dom=a>=0?document.createElementNS("http://www.w3.org/2000/svg",this._model.val("tagname")):document.createElement(this._model.val("tagname")),d=this.attr();for(t in d)e=d[t],this._dom.setAttribute(t,e);for(_=this.getChildren(),s=u=0,m=_.length;m>u;s=++u)n=_[s],l=n.constructor===String?document.createTextNode(n):n.getDom(),this._dom.insertBefore(l,null)}return h=this,null==this._dom._y_xml&&(this._dom._y_xml=this,o.call(this),null!=this.customBind&&this.customBind(),this._model.val("children").observe(function(t){var e,n,o,l,s,i,a,u;for(u=[],i=0,a=t.length;a>i;i++)n=t[i],"insert"===n.type?(o=n.value.getDom(),l=n.reference.getNext(),s="Delimiter"===l.type?null:l.getContent()._dom,u.push(r(function(){return h._dom.insertBefore(o,s)}))):"delete"===n.type?(e=n.reference.val()._dom,null!==e?u.push(r(function(){return h._dom.removeChild(e)})):u.push(void 0)):u.push(void 0);return u}),this._model.val("attributes").observe(function(t){var e,n,o,l,s;for(s=[],o=0,l=t.length;l>o;o++)e=t[o],"add"===e.type||"update"===e.type?(n=e.object.val(e.name),s.push(r(function(){return h._dom.setAttribute(e.name,n)}))):"delete"===e.type?s.push(r(function(){return h._dom.removeAttribute(e.name)})):s.push(void 0);return s}),i=function(){return h._model.val("classes").observe(function(t){var e,n,o,l;for(l=[],n=0,o=t.length;o>n;n++)e=t[n],"add"===e.type||"update"===e.type?l.push(r(function(){return h._dom.classList.add(e.name)})):"delete"===e.type?l.push(r(function(){return h._dom.classList.remove(e.name)})):l.push(void 0);return l})},i(),this._model.observe(function(t){var e,n,o,l;for(l=[],n=0,o=t.length;o>n;n++)e=t[n],"add"===e.type||"update"===e.type?(r(function(){var t;return t=h.attr("class"),null==t||""===t?h._dom.removeAttribute("class"):h._dom.setAttribute("class",h.attr("class"))}),l.push(i())):l.push(void 0);return l})),this._dom},e}(n.Node),n.InputElement=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype._name="Xml.InputElement",e.prototype._getModel=function(){return null==this._model&&e.__super__._getModel.apply(this,arguments),this._model},e.prototype.customBind=function(){var t;return t="",null==this._model.val("value")&&(null!=this._dom&&(t=this._dom.value),this._model.val("value",new Y.Text(t))),this._model.val("value").bind(this._dom)},e}(n.Element),l=!1,s=!1,r=function(t){var e;s=!0;try{t()}catch(n){throw e=n,s=!1,new Error(e)}return s=!1},i=function(t,e,n,r){var o;return null==n&&(n=Element.prototype),o=n[t],n[t]=function(){return null==r&&null==this._y_xml||s?o.apply(this,arguments):null!=this._y_xml?e.apply(this._y_xml,arguments):e.apply(r,arguments)}},o=function(){var t,e,o,s,a,h,u;return u=this,"Xml.Element"===this._name?(t=function(t){return u.addClass(t)},i("add",t,this._dom.classList,this),e=function(t){return u.removeClass(t)},i("remove",e,this._dom.classList,this),this._dom.__defineSetter__("className",function(t){return u.attr("class",t)}),this._dom.__defineGetter__("className",function(){return u.attr("class")}),this._dom.__defineSetter__("textContent",function(t){return u.empty(),""!==t?u.append(t):void 0}),this._dom.__defineGetter__("textContent",function(){var t,e,n,r,o;for(e="",o=u.getChildren(),n=0,r=o.length;r>n;n++)t=o[n],e+=t.constructor===String?t:t._dom.textContent;return e})):"Xml.Text"===this._name&&(this._dom.__defineSetter__("textContent",function(t){return u._model.val("text",t)}),this._dom.__defineGetter__("textContent",function(){return u._model.val("text")})),l?void 0:(l=!0,o=function(t,e){var r,o,l,s,i,a,h,u,m;if(null!=e){for(m=this.getChildren(),o=h=0,u=m.length;u>h;o=++h)if(l=m[o],l.getDom()===e){i=o;break}if(null==i)throw new Error("The adjacentNode is not a child element of this node!")}else i=this.getChildren().length;if(s=[],t.nodeType===t.DOCUMENT_FRAGMENT_NODE)for(r=t.firstChild;null!=r;)s.push(r),r=r.nextSibling;else s.push(t);return a=this,s=s.map(function(t){var e;return null!=t._y_xml?t._y_xml:(e=t.nodeType===t.TEXT_NODE?new n.Text(t):new n.Element(t),e._setParent(a),e)}),this._model.val("children").insertContents(i,s)},i("insertBefore",o),i("appendChild",o),i("removeAttribute",function(t){return this.removeAttr(t)}),i("setAttribute",function(t,e){return this.attr(t,e)}),a=function(t){return t._y_xml.remove()},i("removeChild",a),h=function(t,e){return o.call(this,t,e),a.call(this,e)},i("replaceChild",h),s=function(){var t;return null!=this._model.val("parent")?this.remove():(t=this._dom,r(function(){return t.remove()}))},i("remove",s))},"undefined"!=typeof window&&null!==window){if(null==window.Y)throw new Error("You must first import Y!");if(null==window.Y.List)throw new Error("You must first import Y.List!");window.Y.Xml=n}"undefined"!=typeof e&&null!==e&&(e.exports=n)},{}]},{},[1]);