!function t(e,r,n){function s(o,i){if(!r[o]){if(!e[o]){var a="function"==typeof require&&require;if(!i&&a)return a(o,!0);if(l)return l(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=r[o]={exports:{}};e[o][0].call(u.exports,function(t){var r=e[o][1][t];return s(r?r:t)},u,u.exports,t,e,r,n)}return r[o].exports}for(var l="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e){var r,n,s,l,o;if(r=function(){function t(t,e){var r,n,s,l,o,i,a,u,h;if(null==e&&(e={}),null==t);else if(t.constructor===String){if(o=t,this._xml={},this._xml.children=[],this._xml.tagname=o,e.constructor!==Object)throw new Error("The attributes must be specified as a Object");for(n in e)if(r=e[n],r.constructor!==String)throw new Error("The attributes must be of type String!");if(this._xml.attributes=e,this._xml.classes={},i=this._xml.attributes["class"],delete this._xml.attributes["class"],null!=i)for(h=i.split(" "),s=a=0,u=h.length;u>a;s=++a)l=h[s],s.length>0&&(this._xml.classes[l]=s)}else t instanceof Element&&(this._dom=t,this._xml={})}return t.prototype._name="Xml",t.prototype._getModel=function(e,r){var n,s,l,o,i,a,u,h,m,d,c,f;if(null==this._model){if(null!=this._dom){for(this._xml.tagname=this._dom.tagName.toLowerCase(),this._xml.attributes={},this._xml.classes={},d=this._dom.attributes,o=0,u=d.length;u>o;o++)if(n=d[o],"class"===n.name)for(c=n.value.split(" "),i=0,h=c.length;h>i;i++)s=c[i],this._xml.classes[s]=!0;else this._xml.attributes[n.name]=n.value;for(this._xml.children=[],f=this._dom.childNodes,a=0,m=f.length;m>a;a++)l=f[a],l.nodeType===l.TEXT_NODE?this._xml.children.push(l.textContent):this._xml.children.push(new t(l))}this._model=new r.MapManager(this).execute(),this._model.val("attributes",new e.Object(this._xml.attributes)),this._model.val("classes",new e.Object(this._xml.classes)),this._model.val("tagname",this._xml.tagname),this._model.val("children",new e.List(this._xml.children)),null!=this._xml.parent&&this._model.val("parent",this._xml.parent),null!=this._dom&&this.getDom(),this._setModel(this._model)}return this._model},t.prototype._setModel=function(t){return this._model=t,this._model.observe(function(t){var e,r,n,s,l,o,i,a,u;for(u=[],o=0,i=t.length;i>o;o++)n=t[o],"parent"===n.name&&"add"!==n.type?(l=n.oldValue,r=null!=(a=l._model.val("children"))?a.val():void 0,null!=r?u.push(function(){var t,n,o;for(o=[],s=t=0,n=r.length;n>t;s=++t){if(e=r[s],e===this){l._model.val("children")["delete"](s);break}o.push(void 0)}return o}.call(this)):u.push(void 0)):u.push(void 0);return u}),delete this._xml},t.prototype._setParent=function(e){if(e instanceof t)return null!=this._model?(this.remove(),this._model.val("parent",e)):this._xml.parent=e;throw new Error("parent must be of type Y.Xml!")},t.prototype.toString=function(){var t,e,r,n,s,l,o,i;n="<"+this._model.val("tagname"),o=this.attr();for(e in o)r=o[e],n+=" "+e+'="'+r+'"';for(n+=">",i=this._model.val("children").val(),s=0,l=i.length;l>s;s++)t=i[s],n+=t.toString();return n+="</"+this._model.val("tagname")+">"},t.prototype.attr=function(t,e){var r,n,s,l,o,i;if(arguments.length>1){if(e.constructor!==String)throw new Error("The attributes must be of type String!");if("class"===t){for(s=e.split(" "),l={},o=0,i=s.length;i>o;o++)n=s[o],l[n]=!0;this._model.val("classes",new this._model.custom_types.Object(l))}else this._model.val("attributes").val(t,e);return this}return arguments.length>0?"class"===t?Object.keys(this._model.val("classes").val()).join(" "):this._model.val("attributes").val(t):(r=this._model.val("attributes").val(),s=Object.keys(this._model.val("classes").val()).join(" "),s.length>0&&(r["class"]=s),r)},t.prototype.addClass=function(t){var e,r,n,s;for(s=t.split(" "),r=0,n=s.length;n>r;r++)e=s[r],this._model.val("classes").val(e,!0);return this},t.prototype.after=function(){var e,r,n,s,l,o,i,a,u,h;if(s=this._model.val("parent"),null==s)throw new Error("This Xml Element must not have siblings! (for it does not have a parent)");for(h=s.getChildren(),l=o=0,a=h.length;a>o&&(e=h[l],e!==this);l=++o);for(n=[],i=0,u=arguments.length;u>i;i++){if(r=arguments[i],r instanceof t)r._setParent(this._model.val("parent"));else if(r.constructor!==String)throw new Error("Y.Xml.after expects instances of YXml or String as a parameter");n.push(r)}return s._model.val("children").insertContents(l+1,n)},t.prototype.append=function(){var e,r,n;for(r=0,n=arguments.length;n>r;r++){if(e=arguments[r],e instanceof t)e._setParent(this);else if(e.constructor!==String)throw new Error("Y.Xml.after expects instances of YXml or String as a parameter");this._model.val("children").push(e)}return this},t.prototype.before=function(){var e,r,n,s,l,o,i,a,u,h;if(s=this._model.val("parent"),null==s)throw new Error("This Xml Element must not have siblings! (for it does not have a parent)");for(h=s.getChildren(),l=o=0,a=h.length;a>o&&(e=h[l],e!==this);l=++o);for(n=[],i=0,u=arguments.length;u>i;i++){if(r=arguments[i],r instanceof t)r._setParent(this._model.val("parent"));else if(r.constructor!==String)throw new Error("Y.Xml.after expects instances of YXml or String as a parameter");n.push(r)}return s._model.val("children").insertContents(l,n)},t.prototype.empty=function(){var t,e,r,n,s,l;for(e=this._model.val("children"),s=e.val(),l=[],r=0,n=s.length;n>r;r++)t=s[r],t.constructor===String?l.push(e["delete"](0)):l.push(t.remove());return l},t.prototype.hasClass=function(t){return null!=this._model.val("classes").val(t)?!0:!1},t.prototype.prepend=function(){var e,r,n;for(r=0,n=arguments.length;n>r;r++){if(e=arguments[r],e instanceof t)e._setParent(this);else if(e.constructor!==String)throw new Error("Y.Xml.after expects instances of YXml or String as a parameter");this._model.val("children").insert(0,e)}return this},t.prototype.remove=function(){var t;return t=this._model["delete"]("parent"),this},t.prototype.removeAttr=function(t){return"class"===t?this._model.val("classes",new this._model.custom_types.Object):this._model.val("attributes")["delete"](t),this},t.prototype.removeClass=function(){var t,e,r;if(0===arguments.length)this._model.val("classes",new this._model.custom_types.Object);else for(e=0,r=arguments.length;r>e;e++)t=arguments[e],this._model.val("classes")["delete"](t);return this},t.prototype.toggleClass=function(){var t,e,r,n;for(r=0,n=arguments.length;n>r;r++)t=arguments[r],e=this._model.val("classes"),null!=e.val(t)?e["delete"](t):e.val(t,!0);return this},t.prototype.getParent=function(){return this._model.val("parent")},t.prototype.getChildren=function(){return this._model.val("children").val()},t.prototype.getPosition=function(){var t,e,r,n,s,l;if(r=this._model.val("parent"),null!=r){for(l=r._model.val("children").val(),e=n=0,s=l.length;s>n;e=++n)if(t=l[e],t===this)return e;throw new Error("This is not a child of its parent (should not happen in Y.Xml!)")}return null},t.prototype.getDom=function(){var t,e,r,l,o,i,a,u,h,m,d;if(null==this._dom){this._dom=document.createElement(this._model.val("tagname")),m=this.attr();for(t in m)e=m[t],this._dom.setAttribute(t,e);for(d=this.getChildren(),o=u=0,h=d.length;h>u;o=++u)r=d[o],l=r.constructor===String?document.createTextNode(r):r.getDom(),this._dom.insertBefore(l)}return a=this,null==this._dom._y_xml&&(this._dom._y_xml=this,s.call(this),this._model.val("children").observe(function(t){var e,r,s,l,o,i,u,h;for(h=[],i=0,u=t.length;u>i;i++)s=t[i],"insert"===s.type?(s.value.constructor===String?l=document.createTextNode(s.value):(l=s.value.getDom(),s.value._setParent(a)),e=a._dom.childNodes,o=e.length===s.position?null:e[s.position],h.push(n(function(){return a._dom.insertBefore(l,o)}))):"delete"===s.type?(r=s.oldValue.getDom(),h.push(n(function(){return a._dom.removeChild(r)}))):h.push(void 0);return h}),this._model.val("attributes").observe(function(t){var e,r,s,l,o;for(o=[],s=0,l=t.length;l>s;s++)e=t[s],"add"===e.type||"update"===e.type?(r=e.object.val(e.name),o.push(n(function(){return a._dom.setAttribute(e.name,r)}))):"delete"===e.type?o.push(n(function(){return a._dom.removeAttribute(e.name)})):o.push(void 0);return o}),i=function(){return a._model.val("classes").observe(function(t){var e,r,s,l;for(l=[],r=0,s=t.length;s>r;r++)e=t[r],"add"===e.type||"update"===e.type?l.push(n(function(){return a._dom.classList.add(e.name)})):"delete"===e.type?l.push(n(function(){return a._dom.classList.remove(e.name)})):l.push(void 0);return l})},i(),this._model.observe(function(t){var e,r,s,l;for(l=[],r=0,s=t.length;s>r;r++)e=t[r],"add"===e.type||"update"===e.type?(n(function(){var t;return t=a.attr("class"),null==t||""===t?a._dom.removeAttribute("class"):a._dom.setAttribute("class",a.attr("class"))}),l.push(i())):l.push(void 0);return l})),this._dom},t}(),l=!1,o=!1,n=function(t){var e;o=!0;try{t()}catch(r){throw e=r,o=!1,new Error(e)}return o=!1},s=function(){var t,e,n,s,i,a,u;return u=function(t,e,r,n){var s;return null==r&&(r=Element.prototype),s=r[t],r[t]=function(){return null==n&&null==this._y_xml||o?s.apply(this,arguments):null!=this._y_xml?e.apply(this._y_xml,arguments):e.apply(n,arguments)}},a=this,t=function(t){return a.addClass(t)},u("add",t,this._dom.classList,this),e=function(t){return a.removeClass(t)},u("remove",e,this._dom.classList,this),this._dom.__defineSetter__("className",function(t){return a.attr("class",t)}),this._dom.__defineGetter__("className",function(){return a.attr("class")}),this._dom.__defineSetter__("textContent",function(t){return a.empty(),""!==t?a.append(t):void 0}),l?void 0:(l=!0,n=function(t,e){var n,s,l;if(l=null!=e?e._y_xml.getPosition():this.getChildren().length,s=[],t.nodeType===t.DOCUMENT_FRAGMENT_NODE)for(n=t.firstChild;null!=n;)s.push(n),n=n.nextSibling;else s.push(t);return s=s.map(function(t){return null!=t._y_xml?t._y_xml:t.nodeType===t.TEXT_NODE?t.textContent:new r(t)}),this._model.val("children").insertContents(l,s)},u("insertBefore",n),u("appendChild",n),u("removeAttribute",function(t){return this.removeAttr(t)}),u("setAttribute",function(t,e){return this.attr(t,e)}),s=function(t){return t._y_xml.remove()},u("removeChild",s),i=function(t,e){return n.call(this,t,e),s.call(this,e)},u("replaceChild",i))},"undefined"!=typeof window&&null!==window){if(null==window.Y)throw new Error("You must first import Y!");window.Y.Xml=r}"undefined"!=typeof e&&null!==e&&(e.exports=r)},{}]},{},[1]);