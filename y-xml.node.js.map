{"version":3,"file":"y-xml.node.js","sources":["src/y-xml-text.js","src/utils.js","src/y-xml-fragment.js","src/y-xml-element.js","src/y-xml.js"],"sourcesContent":["/* global getSelection */\n\nimport diff from 'fast-diff'\n\nfunction fixPosition (event, pos) {\n  if (event.index <= pos) {\n    if (event.type === 'delete') {\n      return pos - Math.min(pos - event.index, event.length)\n    } else {\n      return pos + 1\n    }\n  } else {\n    return pos\n  }\n}\n\nexport default function extendYXmlText (Y, _document, _MutationObserver) {\n  Y.requestModules(['Array']).then(function () {\n    class YXmlText extends Y.Array.typeDefinition['class'] {\n      constructor (os, _model, _content, args) {\n        super(os, _model, _content)\n        if (args != null && args.content != null && _model[0] !== '_') {\n          this.insert(0, args.content)\n        }\n        this.dom = null\n        this._domObserver = null\n        this._domObserverListener = null\n        if (args != null && args.dom != null) {\n          this._setDom(args.dom)\n        }\n        var token = true\n        this._mutualExcluse = f => {\n          if (token) {\n            token = false\n            try {\n              f()\n            } catch (e) {\n              console.error(e)\n            }\n            this._domObserver.takeRecords()\n            token = true\n          }\n        }\n        this.observe(event => {\n          if (this.dom != null) {\n            this._mutualExcluse(() => {\n              let selection = null\n              let shouldUpdateSelection = false\n              let anchorNode = null\n              let anchorOffset = null\n              let focusNode = null\n              let focusOffset = null\n              if (typeof getSelection !== 'undefined') {\n                selection = getSelection()\n                if (selection.anchorNode === this.dom) {\n                  anchorNode = selection.anchorNode\n                  anchorOffset = fixPosition(event, selection.anchorOffset)\n                  shouldUpdateSelection = true\n                }\n                if (selection.focusNode === this.dom) {\n                  focusNode = selection.focusNode\n                  focusOffset = fixPosition(event, selection.focusOffset)\n                  shouldUpdateSelection = true\n                }\n              }\n              this.dom.nodeValue = this.toString()\n              if (shouldUpdateSelection) {\n                selection.setBaseAndExtent(\n                  anchorNode || selection.anchorNode,\n                  anchorOffset || selection.anchorOffset,\n                  focusNode || selection.focusNode,\n                  focusOffset || selection.focusOffset\n                )\n              }\n            })\n          }\n        })\n      }\n\n      setDomFilter () {}\n\n      _setDom (dom) {\n        if (this.dom != null) {\n          this._unbindFromDom()\n        }\n        if (dom.__yxml != null) {\n          dom.__yxml._unbindFromDom()\n        }\n        if (_MutationObserver == null) {\n          return\n        }\n        this.dom = dom\n        dom.__yxml = this\n        this._domObserverListener = () => {\n          this._mutualExcluse(() => {\n            var diffs = diff(this.toString(), this.dom.nodeValue)\n            var pos = 0\n            for (var i = 0; i < diffs.length; i++) {\n              var d = diffs[i]\n              if (d[0] === 0) { // EQUAL\n                pos += d[1].length\n              } else if (d[0] === -1) { // DELETE\n                this.delete(pos, d[1].length)\n              } else { // INSERT\n                this.insert(pos, d[1])\n                pos += d[1].length\n              }\n            }\n          })\n        }\n        this._domObserver = new _MutationObserver(this._domObserverListener)\n        this._domObserver.observe(this.dom, { characterData: true })\n      }\n\n      getDom () {\n        if (this.dom == null) {\n          let dom = _document.createTextNode(this.toString())\n          if (_MutationObserver !== null) {\n            this._setDom(dom)\n          }\n          return dom\n        } else {\n          return this.dom\n        }\n      }\n\n      toString () {\n        return this._content.map(function (c) {\n          return c.val\n        }).join('')\n      }\n\n      insert (pos, content) {\n        super.insert(pos, content.split(''))\n      }\n\n      _changed (transaction, op) {\n        if (this._domObserver != null) {\n          this._domObserverListener(this._domObserver.takeRecords())\n        }\n        super._changed(transaction, op)\n      }\n\n      _unbindFromDom () {\n        if (this._domObserver != null) {\n          this._domObserver.disconnect()\n          this._domObserver = null\n        }\n        if (this.dom != null) {\n          this.dom.__yxml = null\n          this.dom = null\n        }\n      }\n\n      _destroy () {\n        if (this._eventListenerHandler != null) {\n          this._eventListenerHandler.destroy()\n        }\n        this._unbindFromDom()\n        super._destroy()\n      }\n    }\n    Y.extend('XmlText', new Y.utils.CustomTypeDefinition({\n      name: 'XmlText',\n      class: YXmlText,\n      struct: 'List',\n      parseArguments: function (arg) {\n        if (typeof arg === 'string') {\n          return [this, { content: arg }]\n        } else if (arg.nodeType === _document.TEXT_NODE) {\n          return [this, { content: arg.nodeValue, dom: arg }]\n        } else {\n          return [this, {}]\n        }\n      },\n      initType: function YXmlTextInitializer (os, model, init) {\n        var _content = []\n        Y.Struct.List.map.call(this, model, function (op) {\n          if (op.hasOwnProperty('opContent')) {\n            throw new Error('Text must not contain types!')\n          } else {\n            op.content.forEach(function (c, i) {\n              _content.push({\n                id: [op.id[0], op.id[1] + i],\n                val: op.content[i]\n              })\n            })\n          }\n        })\n        return new YXmlText(os, model.id, _content, {}, init || {})\n      },\n      createType: function YXmlTextCreator (os, model, args) {\n        return new YXmlText(os, model.id, [], args || {})\n      }\n    }))\n  })\n}\n","\nexport function defaultDomFilter (node, attributes) {\n  return attributes\n}\n\n/*\n * 1. Check if any of the nodes was deleted\n * 2. Iterate over the children.\n *    2.1 If a node exists without __yxml property, insert a new node\n *    2.2 If _contents.length < dom.childNodes.length, fill the\n *        rest of _content with childNodes\n *    2.3 If a node was moved, delete it and\n *       recreate a new yxml element that is bound to that node.\n *       You can detect that a node was moved because expectedId\n *       !== actualId in the list\n */\nexport function applyChangesFromDom (yxml) {\n  let undeletedKnownChildren = Array.prototype.map.call(yxml.dom.childNodes, child => child.__yxml)\n                                    .filter(id => id !== undefined)\n  // 1. Check if any of the nodes was deleted\n  for (let i = yxml._content.length - 1; i >= 0; i--) {\n    let childType = yxml.get(i)\n    if (!undeletedKnownChildren.some(undel => undel === childType)) {\n      yxml.delete(i, 1)\n    }\n  }\n  // 2. iterate\n  let childNodes = yxml.dom.childNodes\n  let len = childNodes.length\n  for (let domCnt = 0, yCnt = 0; domCnt < len; domCnt++) {\n    let child = childNodes[domCnt]\n    if (child.__yxml != null) {\n      if (child.__yxml === false) {\n        continue\n      }\n      if (yCnt < yxml.length) {\n        let expectedNode = yxml.get(yCnt)\n        if (expectedNode !== child.__yxml) {\n          // 2.3 Not expected node\n          let index = yxml._content.findIndex(c => c.type[0] === child.__yxml._model[0] && c.type[1] === child.__yxml._model[1])\n          if (index < 0) {\n            // element is going to be deleted by its previous parent\n            child.__yxml = null\n          } else {\n            yxml.delete(index, 1)\n          }\n          yCnt += yxml.insertDomElements(yCnt, [child])\n        } else {\n          yCnt++\n        }\n        // if this is the expected node id, just continue\n      } else {\n        // 2.2 fill _conten with child nodes\n        yCnt += yxml.insertDomElements(yCnt, [child])\n      }\n    } else {\n      // 2.1 A new node was found\n      yCnt += yxml.insertDomElements(yCnt, [child])\n    }\n  }\n}\n","import { defaultDomFilter, applyChangesFromDom } from './utils.js'\n\nexport default function extendYXmlFragment (Y, _document, _MutationObserver) {\n  Y.requestModules(['Array']).then(function () {\n    class YXmlFragment extends Y.Array.typeDefinition['class'] {\n      constructor (os, _model, _content, args) {\n        super(os, _model, _content)\n        this.dom = null\n        this._domObserver = null\n        this._domObserverListener = null\n        this._domFilter = defaultDomFilter\n        var token = true\n        this._mutualExcluse = f => {\n          if (token) {\n            token = false\n            try {\n              f()\n            } catch (e) {\n              console.error(e)\n            }\n            this._domObserver.takeRecords()\n            token = true\n          }\n        }\n        this.observe(event => {\n          if (this.dom != null) {\n            this._mutualExcluse(() => {\n              if (event.type === 'insert') {\n                for (let i = event.values.length - 1; i >= 0; i--) {\n                  let val = event.values[i]\n                  val.setDomFilter(this._domFilter)\n                  let dom = val.getDom()\n                  let nextDom = null\n                  if (this._content.length > event.index + i + 1) {\n                    nextDom = this.get(event.index + i + 1).getDom()\n                  }\n                  this.dom.insertBefore(dom, nextDom)\n                }\n              } else if (event.type === 'delete') {\n                event.values.forEach(function (yxml) {\n                  yxml.dom.remove()\n                })\n              }\n            })\n          }\n        })\n      }\n\n      setDomFilter (f) {\n        this._domFilter = f\n        this.toArray().forEach(function (c) {\n          c.setDomFilter(f)\n        })\n      }\n\n      insertDomElements () {\n        return Y.XmlElement.typeDefinition.class.prototype.insertDomElements.apply(this, arguments)\n      }\n\n      bindToDom (dom) {\n        if (this.dom != null) {\n          this._unbindFromDom()\n        }\n        if (dom.__yxml != null) {\n          dom.__yxml._unbindFromDom()\n        }\n        if (_MutationObserver == null) {\n          throw new Error('Not able to bind to a DOM element, because MutationObserver is not available!')\n        }\n        dom.innerHTML = ''\n        for (let i = 0; i < this._content.length; i++) {\n          dom.insertBefore(this.get(i).getDom(), null)\n        }\n        this.dom = dom\n        dom.__yxml = this\n        this._domObserverListener = () => {\n          this._mutualExcluse(() => applyChangesFromDom(this))\n        }\n        this._domObserver = new _MutationObserver(this._domObserverListener)\n        this._domObserver.takeRecords() // discard made changes\n        this._domObserver.observe(this.dom, { childList: true })\n      }\n\n      toString () {\n        return this._content\n          .map(c => this.os.getType(c.type).toString())\n          .join('')\n      }\n\n      _changed (transaction, op) {\n        if (this._domObserver != null) {\n          this._domObserverListener(this._domObserver.takeRecords())\n        }\n        super._changed(transaction, op)\n      }\n\n      _unbindFromDom () {\n        if (this._domObserver != null) {\n          this._domObserver.disconnect()\n          this._domObserver = null\n        }\n        if (this.dom != null) {\n          this.dom.__yxml = null\n          this.dom = null\n        }\n      }\n\n      _destroy () {\n        if (this._eventListenerHandler != null) {\n          this._eventListenerHandler.destroy()\n        }\n        this._unbindFromDom()\n        super._destroy()\n      }\n    }\n    Y.extend('XmlFragment', new Y.utils.CustomTypeDefinition({\n      name: 'XmlFragment',\n      class: YXmlFragment,\n      struct: 'List',\n      initType: function YXmlFragmentInitializer (os, model) {\n        var _content = []\n        var _types = []\n        Y.Struct.List.map.call(this, model, function (op) {\n          if (op.hasOwnProperty('opContent')) {\n            _content.push({\n              id: op.id,\n              type: op.opContent\n            })\n            _types.push(op.opContent)\n          } else {\n            op.content.forEach(function (c, i) {\n              _content.push({\n                id: [op.id[0], op.id[1] + i],\n                val: op.content[i]\n              })\n            })\n          }\n        })\n        for (var i = 0; i < _types.length; i++) {\n          var type = this.store.initType.call(this, _types[i])\n          type._parent = model.id\n        }\n        return new YXmlFragment(os, model.id, _content)\n      },\n      createType: function YXmlTextCreator (os, model) {\n        return new YXmlFragment(os, model.id, [])\n      }\n    }))\n  })\n}\n","// import diff from 'fast-diff'\nimport { defaultDomFilter, applyChangesFromDom } from './utils.js'\n\nexport default function extendXmlElement (Y, _document, _MutationObserver) {\n  function yarrayEventHandler (op) {\n    if (op.struct === 'Insert') {\n      // when using indexeddb db adapter, the op could already exist (see y-js/y-indexeddb#2)\n      if (this._content.some(function (c) { return Y.utils.compareIds(c.id, op.id) })) {\n        // op exists\n        return\n      }\n      let pos\n      // we check op.left only!,\n      // because op.right might not be defined when this is called\n      if (op.left === null) {\n        pos = 0\n      } else {\n        pos = 1 + this._content.findIndex(function (c) {\n          return Y.utils.compareIds(c.id, op.left)\n        })\n        if (pos <= 0) {\n          throw new Error('Unexpected operation!')\n        }\n      }\n      /*\n      (see above for new approach)\n      var _e = this._content[pos]\n      // when using indexeddb db adapter, the op could already exist (see y-js/y-indexeddb#2)\n      // If the algorithm works correctly, the double should always exist on the correct position (pos - the computed destination)\n      if (_e != null && Y.utils.compareIds(_e.id, op.id)) {\n        // is already defined\n        return\n      }\n      */\n      var values\n      var length\n      if (op.hasOwnProperty('opContent')) {\n        this._content.splice(pos, 0, {\n          id: op.id,\n          type: op.opContent\n        })\n        length = 1\n        let type = this.os.getType(op.opContent)\n        type._parent = this._model\n        values = [type]\n      } else {\n        var contents = op.content.map(function (c, i) {\n          return {\n            id: [op.id[0], op.id[1] + i],\n            val: c\n          }\n        })\n        // insert value in _content\n        // It is not possible to insert more than ~2^16 elements in an Array (see #5). We handle this case explicitly\n        if (contents.length < 30000) {\n          this._content.splice.apply(this._content, [pos, 0].concat(contents))\n        } else {\n          this._content = this._content.slice(0, pos).concat(contents).concat(this._content.slice(pos))\n        }\n        values = op.content\n        length = op.content.length\n      }\n      Y.utils.bubbleEvent(this, {\n        type: 'insert',\n        object: this,\n        index: pos,\n        values: values,\n        length: length\n      })\n    } else if (op.struct === 'Delete') {\n      var i = 0 // current position in _content\n      for (; i < this._content.length && op.length > 0; i++) {\n        var c = this._content[i]\n        if (Y.utils.inDeletionRange(op, c.id)) {\n          // is in deletion range!\n          var delLength\n          // check how many character to delete in one flush\n          for (delLength = 1;\n                delLength < op.length && i + delLength < this._content.length && Y.utils.inDeletionRange(op, this._content[i + delLength].id);\n                delLength++) {}\n          // last operation that will be deleted\n          c = this._content[i + delLength - 1]\n          // update delete operation\n          op.length -= c.id[1] - op.target[1] + 1\n          op.target = [c.id[0], c.id[1] + 1]\n          // apply deletion & find send event\n          let content = this._content.splice(i, delLength)\n          let values = content.map((c) => {\n            if (c.val != null) {\n              return c.val\n            } else {\n              return this.os.getType(c.type)\n            }\n          })\n          Y.utils.bubbleEvent(this, {\n            type: 'delete',\n            object: this,\n            index: i,\n            values: values,\n            _content: content,\n            length: delLength\n          })\n          // with the fresh delete op, we can continue\n          // note: we don't have to increment i, because the i-th content was deleted\n          // but on the other had, the (i+delLength)-th was not in deletion range\n          // So we don't do i--\n        }\n      }\n    } else {\n      throw new Error('Unexpected struct!')\n    }\n  }\n\n  function ymapEventHandler (op) {\n    var oldValue\n    // key is the name to use to access (op)content\n    var key = op.struct === 'Delete' ? op.key : op.parentSub\n    // compute oldValue\n    if (this.opContents[key] != null) {\n      oldValue = this.os.getType(this.opContents[key])\n    } else {\n      oldValue = this.contents[key]\n    }\n    // compute op event\n    if (op.struct === 'Insert') {\n      if (op.left === null && !Y.utils.compareIds(op.id, this.map[key])) {\n        var value\n        // TODO: what if op.deleted??? I partially handles this case here.. but need to send delete event instead. somehow related to #4\n        if (op.opContent != null) {\n          value = this.os.getType(op.opContent)\n          value._parent = this._model\n          delete this.contents[key]\n          if (op.deleted) {\n            delete this.opContents[key]\n          } else {\n            this.opContents[key] = op.opContent\n          }\n        } else {\n          value = op.content[0]\n          delete this.opContents[key]\n          if (op.deleted) {\n            delete this.contents[key]\n          } else {\n            this.contents[key] = op.content[0]\n          }\n        }\n        this.map[key] = op.id\n        if (oldValue === undefined) {\n          Y.utils.bubbleEvent(this, {\n            name: key,\n            object: this,\n            type: 'add',\n            value: value\n          })\n        } else {\n          Y.utils.bubbleEvent(this, {\n            name: key,\n            object: this,\n            oldValue: oldValue,\n            type: 'update',\n            value: value\n          })\n        }\n      }\n    } else if (op.struct === 'Delete') {\n      if (Y.utils.compareIds(this.map[key], op.target)) {\n        delete this.opContents[key]\n        delete this.contents[key]\n        Y.utils.bubbleEvent(this, {\n          name: key,\n          object: this,\n          oldValue: oldValue,\n          type: 'delete'\n        })\n      }\n    } else {\n      throw new Error('Unexpected Operation!')\n    }\n  }\n\n  class YXmlElement extends Y.utils.CustomType {\n    constructor (os, model, arrayContent, contents, opContents, dom, domFilter) {\n      super()\n      this._os = os\n      this.os = os\n      this._model = model.id\n      this._parent = null\n      // map is the map of attributes (y-map convention)\n      this.map = Y.utils.copyObject(model.map)\n      this.contents = contents\n      this.opContents = opContents\n      // _content is the list of childnotes (y-array convention)\n      this._content = arrayContent\n      this.nodeName = model.nodeName\n      let mapEventHandler = ymapEventHandler.bind(this)\n      let arrayEventHandler = yarrayEventHandler.bind(this)\n      let eventHandler = new Y.utils.EventHandler(function (op) {\n        if (op.parentSub !== undefined || op.key !== undefined) {\n          mapEventHandler(op)\n        } else {\n          arrayEventHandler(op)\n        }\n      })\n      this.eventHandler = eventHandler\n      this._deepEventHandler = new Y.utils.EventListenerHandler()\n      this._eventListenerHandler = eventHandler\n      this._domObserver = null\n      this.dom = null\n      this._domFilter = domFilter\n      if (dom != null) {\n        this._setDom(dom)\n      }\n      // this function makes sure that either the\n      // dom event is executed, or the yjs observer is executed\n      var token = true\n      this._mutualExclude = f => {\n        if (token) {\n          token = false\n          try {\n            f()\n          } catch (e) {\n            console.error(e)\n          }\n          this._domObserver.takeRecords()\n          token = true\n        }\n      }\n      // Apply Y.Xml events to dom\n      this.observe(event => {\n        if (this.dom != null) {\n          this._mutualExclude(() => {\n            if (event.type === 'attributeChanged') {\n              this.dom.setAttribute(event.name, event.value)\n            } else if (event.type === 'attributeRemoved') {\n              this.dom.removeAttribute(event.name)\n            } else if (event.type === 'childInserted') {\n              let nodes = event.nodes\n              for (let i = nodes.length - 1; i >= 0; i--) {\n                let node = nodes[i]\n                node.setDomFilter(this._domFilter)\n                let dom = node.getDom()\n                let nextDom = null\n                if (this._content.length > event.index + i + 1) {\n                  nextDom = this.get(event.index + i + 1).getDom()\n                }\n                this.dom.insertBefore(dom, nextDom)\n              }\n            } else if (event.type === 'childRemoved') {\n              event.values.forEach(function (yxml) {\n                yxml.dom.remove()\n              })\n            }\n          })\n        }\n      })\n    }\n\n    setDomFilter (f) {\n      this._domFilter = f\n      let len = this._content.length\n      for (let i = 0; i < len; i++) {\n        this.get(i).setDomFilter(f)\n      }\n    }\n\n    get length () {\n      return this._content.length\n    }\n\n    toString () {\n      let nodeName = this.nodeName.toLowerCase()\n      let children = this._content\n        .map(c => this.os.getType(c.type).toString())\n        .join('')\n      if (children.length === 0) {\n        return `<${nodeName}/>`\n      } else {\n        return `<${nodeName}>${children}</${nodeName}>`\n      }\n    }\n\n    _getPathToChild (childId) {\n      return this._content.findIndex(c =>\n        c.type != null && Y.utils.compareIds(c.type, childId)\n      )\n    }\n\n    _unbindFromDom () {\n      if (this._domObserver != null) {\n        this._domObserver.disconnect()\n        this._domObserver = null\n      }\n      if (this.dom != null) {\n        this.dom.__yxml = null\n        this.dom = null\n      }\n    }\n\n    _destroy () {\n      this._unbindFromDom()\n      if (this._eventListenerHandler != null) {\n        this._eventListenerHandler.destroy()\n        this._eventListenerHandler = null\n      }\n      this.nodeName = null\n      // y-array destroy\n      this._content = null\n      // y-map destroy\n      this.contents = null\n      this.opContents = null\n      this.map = null\n    }\n\n    insertDomElements (pos, doms) {\n      let types = []\n      doms.forEach(d => {\n        if (d.__yxml != null && d.__yxml !== false) {\n          d.__yxml._unbindFromDom()\n        }\n        if (this._domFilter(d, []) !== null) {\n          let type\n          if (d.nodeType === _document.TEXT_NODE) {\n            type = Y.XmlText(d, this._domFilter)\n          } else if (d.nodeType === _document.ELEMENT_NODE) {\n            type = Y.XmlElement(d, this._domFilter)\n          } else {\n            throw new Error('Unsupported node!')\n          }\n          types.push(type)\n        } else {\n          d.__yxml = false\n        }\n      })\n      this.insert(pos, types)\n      return types.length\n    }\n\n    insert (pos, types) {\n      if (!Array.isArray(types)) {\n        throw new Error('Expected an Array of content!')\n      }\n      for (var i = 0; i < types.length; i++) {\n        var v = types[i]\n        var t = Y.utils.isTypeDefinition(v)\n        if (t == null || (t[0].name !== 'XmlElement' && t[0].name !== 'XmlText')) {\n          throw new Error('Expected Y.Xml type or String!')\n        }\n      }\n      Y.Array.typeDefinition.class.prototype.insert.call(this, pos, types)\n    }\n\n    delete () {\n      return Y.Array.typeDefinition.class.prototype.delete.apply(this, arguments)\n    }\n\n    get () {\n      return Y.Array.typeDefinition.class.prototype.get.apply(this, arguments)\n    }\n\n    removeAttribute () {\n      return Y.Map.typeDefinition.class.prototype.delete.apply(this, arguments)\n    }\n\n    setAttribute () {\n      return Y.Map.typeDefinition.class.prototype.set.apply(this, arguments)\n    }\n\n    getAttribute () {\n      return Y.Map.typeDefinition.class.prototype.get.apply(this, arguments)\n    }\n\n    getAttributes () {\n      let keys = Y.Map.typeDefinition.class.prototype.keys.apply(this)\n      let obj = {}\n      keys.forEach(key => {\n        let val = Y.Map.typeDefinition.class.prototype.get.call(this, key)\n        if (val != null) {\n          obj[key] = val\n        }\n      })\n      return obj\n    }\n\n    // binds to a dom element\n    // Only call if dom and YXml are isomorph\n    _bindToDom (dom) {\n      this._domObserverListener = mutations => {\n        this._mutualExclude(() => {\n          let diffChildren = false\n          mutations.forEach(mutation => {\n            if (mutation.type === 'attributes') {\n              let name = mutation.attributeName\n              // check if filter accepts attribute\n              if (this._domFilter(this.dom, [name]).length > 0) {\n                var val = mutation.target.getAttribute(name)\n                if (this.getAttribute(name) !== val) {\n                  if (val == null) {\n                    this.removeAttribute(name)\n                  } else {\n                    this.setAttribute(name, val)\n                  }\n                }\n              }\n            } else if (mutation.type === 'childList') {\n              diffChildren = true\n            }\n          })\n          if (diffChildren) {\n            applyChangesFromDom(this)\n          }\n        })\n      }\n      this._domObserver = new _MutationObserver(this._domObserverListener)\n      this._domObserver.observe(dom, { attributes: true, childList: true })\n      return dom\n    }\n\n    _setDom (dom) {\n      if (this.dom != null) {\n        throw new Error('Only call this method if you know what you are doing ;)')\n      } else if (dom.__yxml != null) { // TODO do i need to check this? - no.. but for dev purps..\n        throw new Error('Already bound to an YXml type')\n      } else {\n        dom.__yxml = this\n        // tag is already set in constructor\n        // set attributes\n        let attrNames = []\n        for (let i = 0; i < dom.attributes.length; i++) {\n          attrNames.push(dom.attributes[i].name)\n        }\n        attrNames = this._domFilter(dom, attrNames)\n        for (let i = 0; i < attrNames.length; i++) {\n          let attrName = attrNames[i]\n          let attrValue = dom.getAttribute(attrName)\n          this.setAttribute(attrName, attrValue)\n        }\n        this.insertDomElements(0, Array.prototype.slice.call(dom.childNodes))\n        if (_MutationObserver != null) {\n          this.dom = this._bindToDom(dom)\n        }\n        return dom\n      }\n    }\n\n    getDom () {\n      let dom = this.dom\n      if (dom == null) {\n        dom = _document.createElement(this.nodeName)\n        dom.__yxml = this\n        let attrs = this.getAttributes()\n        for (let key in attrs) {\n          dom.setAttribute(key, attrs[key])\n        }\n        for (var i = 0; i < this._content.length; i++) {\n          let c = this._content[i]\n          let type = this.os.getType(c.type)\n          dom.appendChild(type.getDom())\n        }\n        if (_MutationObserver !== null) {\n          this.dom = this._bindToDom(dom)\n        }\n      }\n      return dom\n    }\n\n    observe (f) {\n      function observeWrapper (event) {\n        if (event.type === 'insert') {\n          f({\n            type: 'childInserted',\n            index: event.index,\n            nodes: event.values\n          })\n        } else if (event.type === 'delete') {\n          if (event.index !== undefined) {\n            f({\n              type: 'childRemoved',\n              index: event.index,\n              values: event.values,\n              _content: event._content\n            })\n          } else {\n            f({\n              type: 'attributeRemoved',\n              name: event.name\n            })\n          }\n        } else if (event.type === 'update' || event.type === 'add') {\n          f({\n            type: 'attributeChanged',\n            name: event.name,\n            value: event.value\n          })\n        } else {\n          throw new Error('Unexpected event')\n        }\n      }\n      this._eventListenerHandler.addEventListener(observeWrapper)\n      return observeWrapper\n    }\n\n    unobserve (f) {\n      this._eventListenerHandler.removeEventListener(f)\n    }\n    observeDeep (f) {\n      this._deepEventHandler.addEventListener(f)\n    }\n    unobserveDeep (f) {\n      this._deepEventHandler.removeEventListener(f)\n    }\n\n    _changed (transaction, op) {\n      if (this._domObserver != null) {\n        this._domObserverListener(this._domObserver.takeRecords())\n      }\n      if (op.parentSub !== undefined || op.targetParent !== undefined) {\n        Y.Map.typeDefinition['class'].prototype._changed.apply(this, arguments)\n      } else {\n        Y.Array.typeDefinition['class'].prototype._changed.apply(this, arguments)\n      }\n    }\n  }\n\n  Y.extend('XmlElement', new Y.utils.CustomTypeDefinition({\n    name: 'XmlElement',\n    class: YXmlElement,\n    struct: 'Xml',\n    parseArguments: function (arg, arg2) {\n      let domFilter\n      if (typeof arg2 === 'function') {\n        domFilter = arg2\n      } else {\n        domFilter = defaultDomFilter\n      }\n      if (typeof arg === 'string') {\n        return [this, {\n          nodeName: arg.toUpperCase(),\n          dom: null,\n          domFilter\n        }]\n      } else if (arg.nodeType === _document.ELEMENT_NODE) {\n        return [this, {\n          nodeName: arg.nodeName,\n          dom: arg,\n          domFilter\n        }]\n      } else {\n        throw new Error('Y.XmlElement requires an argument which is a string!')\n      }\n    },\n    initType: function YXmlElementInitializer (os, model, init) {\n      // here begins the modified y-array init\n      var _content = []\n      var _types = []\n      Y.Struct.Xml.map.call(this, model, function (op) {\n        if (op.hasOwnProperty('opContent')) {\n          _content.push({\n            id: op.id,\n            type: op.opContent\n          })\n          _types.push(op.opContent)\n        } else {\n          op.content.forEach(function (c, i) {\n            _content.push({\n              id: [op.id[0], op.id[1] + i],\n              val: op.content[i]\n            })\n          })\n        }\n      })\n      for (var i = 0; i < _types.length; i++) {\n        let type = this.store.initType.call(this, _types[i], init)\n        type._parent = model.id\n      }\n      // here begins the modified y-map init\n      var contents = {}\n      var opContents = {}\n      var map = model.map\n      for (var name in map) {\n        var op = this.getOperation(map[name])\n        if (op.deleted) continue\n        if (op.opContent != null) {\n          opContents[name] = op.opContent\n          this.store.initType.call(this, op.opContent)\n        } else {\n          contents[name] = op.content[0]\n        }\n      }\n      return new YXmlElement(os, model, _content, contents, opContents, init != null ? init.dom : null, init != null ? init.domFilter : defaultDomFilter)\n    },\n    createType: function YXmlElementCreator (os, model, args) {\n      return new YXmlElement(os, model, [], {}, {}, args.dom, args.domFilter)\n    }\n  }))\n}\n","/* global Y, MutationObserver */\n\nimport yXmlText from './y-xml-text.js'\nimport yXmlFragment from './y-xml-fragment.js'\nimport yXmlElement from './y-xml-element.js'\n\nexport default function extendXml (Y, _document, _MutationObserver) {\n  if (_document == null && typeof document !== 'undefined') {\n    _document = document\n  }\n  if (typeof MutationObserver !== 'undefined') {\n    _MutationObserver = MutationObserver\n  } else {\n    _MutationObserver = null\n  }\n  yXmlElement(Y, _document, _MutationObserver)\n  yXmlText(Y, _document, _MutationObserver)\n  yXmlFragment(Y, _document, _MutationObserver)\n}\n\nif (typeof Y !== 'undefined') {\n  extendXml(Y)\n}\n"],"names":["yXmlElement","yXmlText","yXmlFragment"],"mappings":"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"}