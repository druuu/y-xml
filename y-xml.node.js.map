{"version":3,"file":"y-xml.node.js","sources":["src/y-xml.js"],"sourcesContent":["/* global Y, MutationObserver, Element, Text */\n\nfunction yarrayEventHandler (op) {\n  if (op.struct === 'Insert') {\n    // when using indexeddb db adapter, the op could already exist (see y-js/y-indexeddb#2)\n    if (this._content.some(function (c) { return Y.utils.compareIds(c.id, op.id) })) {\n      // op exists\n      return\n    }\n    let pos\n    // we check op.left only!,\n    // because op.right might not be defined when this is called\n    if (op.left === null) {\n      pos = 0\n    } else {\n      pos = 1 + this._content.findIndex(function (c) {\n        return Y.utils.compareIds(c.id, op.left)\n      })\n      if (pos <= 0) {\n        throw new Error('Unexpected operation!')\n      }\n    }\n    /*\n    (see above for new approach)\n    var _e = this._content[pos]\n    // when using indexeddb db adapter, the op could already exist (see y-js/y-indexeddb#2)\n    // If the algorithm works correctly, the double should always exist on the correct position (pos - the computed destination)\n    if (_e != null && Y.utils.compareIds(_e.id, op.id)) {\n      // is already defined\n      return\n    }\n    */\n    var values\n    var length\n    if (op.hasOwnProperty('opContent')) {\n      this._content.splice(pos, 0, {\n        id: op.id,\n        type: op.opContent\n      })\n      length = 1\n      let type = this.os.getType(op.opContent)\n      type._parent = this._model\n      values = [type]\n    } else {\n      var contents = op.content.map(function (c, i) {\n        return {\n          id: [op.id[0], op.id[1] + i],\n          val: c\n        }\n      })\n      // insert value in _content\n      // It is not possible to insert more than ~2^16 elements in an Array (see #5). We handle this case explicitly\n      if (contents.length < 30000) {\n        this._content.splice.apply(this._content, [pos, 0].concat(contents))\n      } else {\n        this._content = this._content.slice(0, pos).concat(contents).concat(this._content.slice(pos))\n      }\n      values = op.content\n      length = op.content.length\n    }\n    Y.utils.bubbleEvent(this, {\n      type: 'insert',\n      object: this,\n      index: pos,\n      values: values,\n      length: length\n    })\n  } else if (op.struct === 'Delete') {\n    var i = 0 // current position in _content\n    for (; i < this._content.length && op.length > 0; i++) {\n      var c = this._content[i]\n      if (Y.utils.inDeletionRange(op, c.id)) {\n        // is in deletion range!\n        var delLength\n        // check how many character to delete in one flush\n        for (delLength = 1;\n              delLength < op.length && i + delLength < this._content.length && Y.utils.inDeletionRange(op, this._content[i + delLength].id);\n              delLength++) {}\n        // last operation that will be deleted\n        c = this._content[i + delLength - 1]\n        // update delete operation\n        op.length -= c.id[1] - op.target[1] + 1\n        op.target = [c.id[0], c.id[1] + 1]\n        // apply deletion & find send event\n        let content = this._content.splice(i, delLength)\n        let values = content.map((c) => {\n          if (c.val != null) {\n            return c.val\n          } else {\n            return this.os.getType(c.type)\n          }\n        })\n        Y.utils.bubbleEvent(this, {\n          type: 'delete',\n          object: this,\n          index: i,\n          values: values,\n          _content: content,\n          length: delLength\n        })\n        // with the fresh delete op, we can continue\n        // note: we don't have to increment i, because the i-th content was deleted\n        // but on the other had, the (i+delLength)-th was not in deletion range\n        // So we don't do i--\n      }\n    }\n  } else {\n    throw new Error('Unexpected struct!')\n  }\n}\n\nfunction ymapEventHandler (op) {\n  var oldValue\n  // key is the name to use to access (op)content\n  var key = op.struct === 'Delete' ? op.key : op.parentSub\n  // compute oldValue\n  if (this.opContents[key] != null) {\n    oldValue = this.os.getType(this.opContents[key])\n  } else {\n    oldValue = this.contents[key]\n  }\n  // compute op event\n  if (op.struct === 'Insert') {\n    if (op.left === null && !Y.utils.compareIds(op.id, this.map[key])) {\n      var value\n      // TODO: what if op.deleted??? I partially handles this case here.. but need to send delete event instead. somehow related to #4\n      if (op.opContent != null) {\n        value = this.os.getType(op.opContent)\n        value._parent = this._model\n        delete this.contents[key]\n        if (op.deleted) {\n          delete this.opContents[key]\n        } else {\n          this.opContents[key] = op.opContent\n        }\n      } else {\n        value = op.content[0]\n        delete this.opContents[key]\n        if (op.deleted) {\n          delete this.contents[key]\n        } else {\n          this.contents[key] = op.content[0]\n        }\n      }\n      this.map[key] = op.id\n      if (oldValue === undefined) {\n        Y.utils.bubbleEvent(this, {\n          name: key,\n          object: this,\n          type: 'add',\n          value: value\n        })\n      } else {\n        Y.utils.bubbleEvent(this, {\n          name: key,\n          object: this,\n          oldValue: oldValue,\n          type: 'update',\n          value: value\n        })\n      }\n    }\n  } else if (op.struct === 'Delete') {\n    if (Y.utils.compareIds(this.map[key], op.target)) {\n      delete this.opContents[key]\n      delete this.contents[key]\n      Y.utils.bubbleEvent(this, {\n        name: key,\n        object: this,\n        oldValue: oldValue,\n        type: 'delete'\n      })\n    }\n  } else {\n    throw new Error('Unexpected Operation!')\n  }\n}\n\nexport function extendXml (Y) {\n  class YXml extends Y.utils.CustomType {\n    constructor (os, model, arrayContent, contents, opContents) {\n      super()\n      this._os = os\n      this._model = model\n      // map is the map of attributes (y-map convention)\n      this.map = Y.utils.copyObject(model.map)\n      this.contents = contents\n      this.opContents = opContents\n      // _content is the list of childnotes (y-array convention)\n      this._content = arrayContent\n      this.nodeName = model.nodeName\n      this._domObserver = null\n      this._dom = null\n      let mapEventHandler = ymapEventHandler.bind(this)\n      let arrayEventHandler = yarrayEventHandler.bind(this)\n      this._eventListenerHandler = new Y.utils.EventListenerHandler(function (op) {\n        if (op.parentSub !== undefined) {\n          mapEventHandler(op)\n        } else {\n          arrayEventHandler(op)\n        }\n      })\n    }\n\n    _destroy () {\n      if (this._domObserver != null) {\n        this._domObserver.disconnect()\n      }\n      this._eventListenerHandler.destroy()\n      this._eventListenerHandler = null\n      this._nodeName = null\n      this._dom = null\n      // y-array destroy\n      this._content = null\n      // y-map destroy\n      this.contents = null\n      this.opContents = null\n      this.map = null\n    }\n\n    insert (pos, types) {\n      var _types = []\n      if (!Array.isArray(types)) {\n        throw new Error('Expected an Array of content!')\n      }\n      for (var i = 0; i < types.length; i++) {\n        var v = types[i]\n        var t = Y.utils.isTypeDefinition(v)\n        if (!(v != null && (\n                     typeof v === 'string' ||\n                     (t && t[0].class === YXml)\n           ))) {\n          throw new Error('Expected Y.Xml type or String!')\n        } else if (typeof v === 'string' && v.length === 0) {\n          continue // if empty string\n        }\n        _types.push(v)\n      }\n      Y.Array.typeDefinition.class.prototype.insert.call(this, pos, types)\n    }\n\n    delete () {\n      Y.Array.typeDefinition.class.prototype.delete.apply(this, arguments)\n    }\n\n    setAttribute () {\n      Y.Map.typeDefinition.class.prototype.set.apply(this, arguments)\n    }\n\n    getAttribute () {\n      Y.Map.typeDefinition.class.prototype.get.apply(this, arguments)\n    }\n\n    getAttributes () {\n      let keys = Y.Map.typeDefinition.class.prototype.keys.apply(this)\n      let obj = {}\n      keys.forEach(key => {\n        obj[key] = Y.Map.typeDefinition.class.prototype.get.call(this, key)\n      })\n      return obj\n    }\n\n    // binds to a dom element\n    // Only call if dom and YXml are isomorph\n    _bindToDom (dom) {\n      // this function makes sure that either the\n      // dom event is executed, or the yjs observer is executed\n      var token = true\n      var mutualExclude = f => {\n        // take and process current records\n        var records = this._domObserver.takeRecords()\n        if (records.length > 0) {\n          this._domObserverListener(records)\n        }\n        if (token) {\n          token = false\n          try {\n            f()\n          } catch (e) {\n            // discard created records\n            this._domObserver.takeRecords()\n            token = true\n            throw e\n          }\n          this._domObserver.takeRecords()\n          token = true\n        }\n      }\n      this._mutualExclude = mutualExclude\n      this._domObserverListener = mutations => {\n        mutualExclude(() => {\n          mutations.forEach(mutation => {\n            if (mutation.type === 'attributes') {\n              var name = mutation.attributeName\n              var val = mutation.target.getAttribute(mutation.attributeName)\n              if (this.getAttribute(name) !== val) {\n                this.setAttribute(name, val)\n              }\n            } else if (mutation.type === 'childList') {\n              for (let i = 0; i < mutation.addedNodes.length; i++) {\n                let n = mutation.addedNodes[i]\n                if (this._content.some(function (c) { return c.dom === n })) {\n                  // check if it already exists (since this method is called asynchronously)\n                  continue\n                }\n                if (n instanceof Text && n.textContent === '') {\n                  // check if textnode and empty content (sometime happens.. )\n                  //   TODO - you could also check if the inserted node actually exists in the\n                  //          dom (in order to cover more potential cases)\n                  n.remove()\n                  continue\n                }\n                // compute position\n                // special case, n.nextSibling is not yet inserted. So we find the next inserted element!\n                var pos = -1\n                var nextSibling = n.nextSibling\n                while (pos < 0) {\n                  if (nextSibling == null) {\n                    pos = this._content.length\n                  } else {\n                    pos = this._content.findIndex(function (c) { return c.dom === nextSibling })\n                    nextSibling = nextSibling.nextSibling\n                  }\n                }\n                var c\n                if (n instanceof Text) {\n                  c = n.textContent\n                } else if (n instanceof Element) {\n                  c = Y.Xml(n)\n                } else {\n                  throw new Error('Unsupported XML Element found. Synchronization will no longer work!')\n                }\n                this.insert(pos, [c])\n                var content = this._content[pos]\n                content.dom = n\n              }\n              Array.prototype.forEach.call(mutation.removedNodes, n => {\n                var pos = this._content.findIndex(function (c) {\n                  return c.dom === n\n                })\n                if (pos >= 0) {\n                  this.delete(pos)\n                } else {\n                  throw new Error('An unexpected condition occured (deleted node does not exist in the model)!')\n                }\n              })\n            }\n          })\n        })\n      }\n      this._domObserver = new MutationObserver(this._domObserverListener)\n      this._domObserver.observe(dom, { attributes: true, childList: true })\n      // In order to insert a new node, successor needs to be inserted\n      // when c.dom can be inserted, try to insert the predecessors too\n      var _tryInsertDom = (pos) => {\n        var c = this._content[pos]\n        var succ\n        if (pos + 1 < this._content.length) {\n          succ = this._content[pos + 1]\n          if (succ.dom == null) throw new Error('Unexpected behavior') // shouldn't happen anymore!\n        } else {\n          // pseudo successor\n          succ = {\n            dom: null\n          }\n        }\n        dom.insertBefore(c.dom, succ.dom)\n      }\n      this._tryInsertDom = _tryInsertDom\n      this.observe(event => {\n        mutualExclude(() => {\n          if (event.type === 'attributeChanged') {\n            dom.setAttribute(event.name, event.value)\n          } else if (event.type === 'attributeRemoved') {\n            dom.removeAttribute(event.name)\n          } else if (event.type === 'childInserted') {\n            if (event.nodes.length === 1 && event.nodes[0] instanceof YXml) {\n              // a new xml node was inserted.\n              // TODO: consider the case that nodes contains mixed text & types (currently not implemented in yjs)\n              var valId = this._content[event.index].id\n              if (event.nodes.length > 1) { throw new Error('This case is not handled, you\\'ll run into consistency issues. Contact the developer') }\n              var newNode = event.nodes[0].getDom()\n              // This is called async. So we have to compute the position again\n              // also mutual excluse this\n              var pos\n              if (event.index < this._content.length && Y.utils.compareIds(this._content[event.index].id, valId)) {\n                pos = event.index\n              } else {\n                pos = this._content.findIndex(function (c) {\n                  return Y.utils.compareIds(c.id, valId)\n                })\n              }\n              if (pos >= 0) {\n                this._content[pos].dom = newNode\n                _tryInsertDom(pos)\n              }\n            } else {\n              for (var i = event.nodes.length - 1; i >= 0; i--) {\n                var n = event.nodes[i]\n                var textNode = new Text(n)\n                this._content[event.index + i].dom = textNode\n                _tryInsertDom(event.index + i)\n              }\n            }\n          } else if (event.type === 'childRemoved') {\n            event._content.forEach(function (c) {\n              if (c.dom != null) {\n                c.dom.remove()\n              }\n            })\n          }\n        })\n      })\n      return dom\n    }\n\n    getDom () {\n      if (this.dom == null) {\n        var dom = document.createElement(this.tagname)\n        dom.__yxml = this\n        let attrs = this.getAttributes()\n        for (let key in attrs) {\n          dom.setAttribute(key, attrs[key])\n        }\n\n        for (var i = 0; i < this._content.length; i++) {\n          let c = this._content[i]\n          if (c.hasOwnProperty('val')) {\n            c.dom = new Text(c.val)\n          } else {\n            c.dom = this.os.getType(c.type).getDom()\n          }\n          dom.appendChild(c.dom)\n        }\n        this.dom = this._bindToDom(dom)\n      }\n      return this.dom\n    }\n\n    observe (f) {\n      function observeWrapper (event) {\n        if (event.type === 'insert') {\n          f({\n            type: 'childInserted',\n            index: event.index,\n            nodes: event.values\n          })\n        } else if (event.type === 'delete') {\n          if (event.index !== undefined) {\n            f({\n              type: 'childRemoved',\n              index: event.index,\n              values: event.values\n            })\n          } else {\n            f({\n              type: 'attributeRemoved',\n              name: event.name\n            })\n          }\n        } else if (event.type === 'update' || event.type === 'add') {\n          f({\n            type: 'attributeChanged',\n            name: event.name,\n            value: event.value\n          })\n        } else {\n          throw new Error('Unexpected event')\n        }\n      }\n      this._eventListenerHandler.addEventListener(observeWrapper)\n      return observeWrapper\n    }\n\n    unobserve (f) {\n      this._eventListenerHandler.removeEventListener(f)\n    }\n\n    * _changed (transaction, op) {\n      if (this._domObserver != null) {\n        this._domObserverListener(this._domObserver.takeRecords())\n      }\n      if (op.parentSub) {\n        yield * Y.Map.typeDefinition['class'].prototype._changed.apply(this, arguments)\n      } else {\n        yield * Y.Array.typeDefinition['class'].prototype._changed.apply(this, arguments)\n      }\n    }\n  }\n  Y.extend('Xml', new Y.utils.CustomTypeDefinition({\n    name: 'Xml',\n    class: YXml,\n    struct: 'Xml',\n    parseArguments: function (tagname) {\n      if (typeof tagname === 'string') {\n        return [this, tagname]\n      } else {\n        throw new Error('Y.Xml requires an argument which is a string!')\n      }\n    },\n    initType: function * YXmlInitializer (os, model, nodeName) {\n      // here begins the modified y-array init\n      var _content = []\n      var _types = []\n      yield * Y.Struct.Xml.map.call(this, model, function (op) {\n        if (op.hasOwnProperty('opContent')) {\n          _content.push({\n            id: op.id,\n            type: op.opContent\n          })\n          _types.push(op.opContent)\n        } else {\n          op.content.forEach(function (c, i) {\n            _content.push({\n              id: [op.id[0], op.id[1] + i],\n              val: op.content[i]\n            })\n          })\n        }\n      })\n      for (var i = 0; i < _types.length; i++) {\n        yield * os.initType.call(this, _types[i])\n      }\n      // here begins the modified y-map init\n      var contents = {}\n      var opContents = {}\n      var map = model.map\n      for (var name in map) {\n        var op = yield * this.getOperation(map[name])\n        if (op.deleted) continue\n        if (op.opContent != null) {\n          opContents[name] = op.opContent\n          yield * this.store.initType.call(this, op.opContent)\n        } else {\n          contents[name] = op.content[0]\n        }\n      }\n      return new YXml(os, model, _content, contents, opContents)\n    },\n    createType: function YXmlCreator (os, model, args) {\n      return new YXml(os, model, [], {}, {})\n    }\n  }))\n}\n\nif (typeof Y !== 'undefined') {\n  extendXml(Y)\n}\n"],"names":[],"mappings":"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"}