{"version":3,"file":"y-xml.js","sources":["src/y-xml.js"],"sourcesContent":["/* global Y, MutationObserver, Element, Text */\n\nfunction yarrayEventHandler (op) {\n  if (op.struct === 'Insert') {\n    // when using indexeddb db adapter, the op could already exist (see y-js/y-indexeddb#2)\n    if (this._content.some(function (c) { return Y.utils.compareIds(c.id, op.id) })) {\n      // op exists\n      return\n    }\n    let pos\n    // we check op.left only!,\n    // because op.right might not be defined when this is called\n    if (op.left === null) {\n      pos = 0\n    } else {\n      pos = 1 + this._content.findIndex(function (c) {\n        return Y.utils.compareIds(c.id, op.left)\n      })\n      if (pos <= 0) {\n        throw new Error('Unexpected operation!')\n      }\n    }\n    /*\n    (see above for new approach)\n    var _e = this._content[pos]\n    // when using indexeddb db adapter, the op could already exist (see y-js/y-indexeddb#2)\n    // If the algorithm works correctly, the double should always exist on the correct position (pos - the computed destination)\n    if (_e != null && Y.utils.compareIds(_e.id, op.id)) {\n      // is already defined\n      return\n    }\n    */\n    var values\n    var length\n    if (op.hasOwnProperty('opContent')) {\n      this._content.splice(pos, 0, {\n        id: op.id,\n        type: op.opContent\n      })\n      length = 1\n      let type = this.os.getType(op.opContent)\n      type._parent = this._model\n      values = [type]\n    } else {\n      var contents = op.content.map(function (c, i) {\n        return {\n          id: [op.id[0], op.id[1] + i],\n          val: c\n        }\n      })\n      // insert value in _content\n      // It is not possible to insert more than ~2^16 elements in an Array (see #5). We handle this case explicitly\n      if (contents.length < 30000) {\n        this._content.splice.apply(this._content, [pos, 0].concat(contents))\n      } else {\n        this._content = this._content.slice(0, pos).concat(contents).concat(this._content.slice(pos))\n      }\n      values = op.content\n      length = op.content.length\n    }\n    Y.utils.bubbleEvent(this, {\n      type: 'insert',\n      object: this,\n      index: pos,\n      values: values,\n      length: length\n    })\n  } else if (op.struct === 'Delete') {\n    var i = 0 // current position in _content\n    for (; i < this._content.length && op.length > 0; i++) {\n      var c = this._content[i]\n      if (Y.utils.inDeletionRange(op, c.id)) {\n        // is in deletion range!\n        var delLength\n        // check how many character to delete in one flush\n        for (delLength = 1;\n              delLength < op.length && i + delLength < this._content.length && Y.utils.inDeletionRange(op, this._content[i + delLength].id);\n              delLength++) {}\n        // last operation that will be deleted\n        c = this._content[i + delLength - 1]\n        // update delete operation\n        op.length -= c.id[1] - op.target[1] + 1\n        op.target = [c.id[0], c.id[1] + 1]\n        // apply deletion & find send event\n        let content = this._content.splice(i, delLength)\n        let values = content.map((c) => {\n          if (c.val != null) {\n            return c.val\n          } else {\n            return this.os.getType(c.type)\n          }\n        })\n        Y.utils.bubbleEvent(this, {\n          type: 'delete',\n          object: this,\n          index: i,\n          values: values,\n          _content: content,\n          length: delLength\n        })\n        // with the fresh delete op, we can continue\n        // note: we don't have to increment i, because the i-th content was deleted\n        // but on the other had, the (i+delLength)-th was not in deletion range\n        // So we don't do i--\n      }\n    }\n  } else {\n    throw new Error('Unexpected struct!')\n  }\n}\n\nfunction ymapEventHandler (op) {\n  var oldValue\n  // key is the name to use to access (op)content\n  var key = op.struct === 'Delete' ? op.key : op.parentSub\n  // compute oldValue\n  if (this.opContents[key] != null) {\n    oldValue = this.os.getType(this.opContents[key])\n  } else {\n    oldValue = this.contents[key]\n  }\n  // compute op event\n  if (op.struct === 'Insert') {\n    if (op.left === null && !Y.utils.compareIds(op.id, this.map[key])) {\n      var value\n      // TODO: what if op.deleted??? I partially handles this case here.. but need to send delete event instead. somehow related to #4\n      if (op.opContent != null) {\n        value = this.os.getType(op.opContent)\n        value._parent = this._model\n        delete this.contents[key]\n        if (op.deleted) {\n          delete this.opContents[key]\n        } else {\n          this.opContents[key] = op.opContent\n        }\n      } else {\n        value = op.content[0]\n        delete this.opContents[key]\n        if (op.deleted) {\n          delete this.contents[key]\n        } else {\n          this.contents[key] = op.content[0]\n        }\n      }\n      this.map[key] = op.id\n      if (oldValue === undefined) {\n        Y.utils.bubbleEvent(this, {\n          name: key,\n          object: this,\n          type: 'add',\n          value: value\n        })\n      } else {\n        Y.utils.bubbleEvent(this, {\n          name: key,\n          object: this,\n          oldValue: oldValue,\n          type: 'update',\n          value: value\n        })\n      }\n    }\n  } else if (op.struct === 'Delete') {\n    if (Y.utils.compareIds(this.map[key], op.target)) {\n      delete this.opContents[key]\n      delete this.contents[key]\n      Y.utils.bubbleEvent(this, {\n        name: key,\n        object: this,\n        oldValue: oldValue,\n        type: 'delete'\n      })\n    }\n  } else {\n    throw new Error('Unexpected Operation!')\n  }\n}\n\nexport function extendXml (Y) {\n  class YXml extends Y.utils.CustomType {\n    constructor (os, model, arrayContent, contents, opContents) {\n      super()\n      this._os = os\n      this._model = model\n      // map is the map of attributes (y-map convention)\n      this.map = Y.utils.copyObject(model.map)\n      this.contents = contents\n      this.opContents = opContents\n      // _content is the list of childnotes (y-array convention)\n      this._content = arrayContent\n      this.nodeName = model.nodeName\n      this._domObserver = null\n      this._dom = null\n      let mapEventHandler = ymapEventHandler.bind(this)\n      let arrayEventHandler = yarrayEventHandler.bind(this)\n      this._eventListenerHandler = new Y.utils.EventListenerHandler(function (op) {\n        if (op.parentSub !== undefined) {\n          mapEventHandler(op)\n        } else {\n          arrayEventHandler(op)\n        }\n      })\n    }\n\n    _destroy () {\n      if (this._domObserver != null) {\n        this._domObserver.disconnect()\n      }\n      this._eventListenerHandler.destroy()\n      this._eventListenerHandler = null\n      this._nodeName = null\n      this._dom = null\n      // y-array destroy\n      this._content = null\n      // y-map destroy\n      this.contents = null\n      this.opContents = null\n      this.map = null\n    }\n\n    insert (pos, types) {\n      var _types = []\n      if (!Array.isArray(types)) {\n        throw new Error('Expected an Array of content!')\n      }\n      for (var i = 0; i < types.length; i++) {\n        var v = types[i]\n        var t = Y.utils.isTypeDefinition(v)\n        if (!(v != null && (\n                     typeof v === 'string' ||\n                     (t && t[0].class === YXml)\n           ))) {\n          throw new Error('Expected Y.Xml type or String!')\n        } else if (typeof v === 'string' && v.length === 0) {\n          continue // if empty string\n        }\n        _types.push(v)\n      }\n      Y.Array.typeDefinition.class.prototype.insert.call(this, pos, types)\n    }\n\n    delete () {\n      Y.Array.typeDefinition.class.prototype.delete.apply(this, arguments)\n    }\n\n    setAttribute () {\n      Y.Map.typeDefinition.class.prototype.set.apply(this, arguments)\n    }\n\n    getAttribute () {\n      Y.Map.typeDefinition.class.prototype.get.apply(this, arguments)\n    }\n\n    getAttributes () {\n      let keys = Y.Map.typeDefinition.class.prototype.keys.apply(this)\n      let obj = {}\n      keys.forEach(key => {\n        obj[key] = Y.Map.typeDefinition.class.prototype.get.call(this, key)\n      })\n      return obj\n    }\n\n    // binds to a dom element\n    // Only call if dom and YXml are isomorph\n    _bindToDom (dom) {\n      // this function makes sure that either the\n      // dom event is executed, or the yjs observer is executed\n      var token = true\n      var mutualExclude = f => {\n        // take and process current records\n        var records = this._domObserver.takeRecords()\n        if (records.length > 0) {\n          this._domObserverListener(records)\n        }\n        if (token) {\n          token = false\n          try {\n            f()\n          } catch (e) {\n            // discard created records\n            this._domObserver.takeRecords()\n            token = true\n            throw e\n          }\n          this._domObserver.takeRecords()\n          token = true\n        }\n      }\n      this._mutualExclude = mutualExclude\n      this._domObserverListener = mutations => {\n        mutualExclude(() => {\n          mutations.forEach(mutation => {\n            if (mutation.type === 'attributes') {\n              var name = mutation.attributeName\n              var val = mutation.target.getAttribute(mutation.attributeName)\n              if (this.getAttribute(name) !== val) {\n                this.setAttribute(name, val)\n              }\n            } else if (mutation.type === 'childList') {\n              for (let i = 0; i < mutation.addedNodes.length; i++) {\n                let n = mutation.addedNodes[i]\n                if (this._content.some(function (c) { return c.dom === n })) {\n                  // check if it already exists (since this method is called asynchronously)\n                  continue\n                }\n                if (n instanceof Text && n.textContent === '') {\n                  // check if textnode and empty content (sometime happens.. )\n                  //   TODO - you could also check if the inserted node actually exists in the\n                  //          dom (in order to cover more potential cases)\n                  n.remove()\n                  continue\n                }\n                // compute position\n                // special case, n.nextSibling is not yet inserted. So we find the next inserted element!\n                var pos = -1\n                var nextSibling = n.nextSibling\n                while (pos < 0) {\n                  if (nextSibling == null) {\n                    pos = this._content.length\n                  } else {\n                    pos = this._content.findIndex(function (c) { return c.dom === nextSibling })\n                    nextSibling = nextSibling.nextSibling\n                  }\n                }\n                var c\n                if (n instanceof Text) {\n                  c = n.textContent\n                } else if (n instanceof Element) {\n                  c = Y.Xml(n)\n                } else {\n                  throw new Error('Unsupported XML Element found. Synchronization will no longer work!')\n                }\n                this.insert(pos, [c])\n                var content = this._content[pos]\n                content.dom = n\n              }\n              Array.prototype.forEach.call(mutation.removedNodes, n => {\n                var pos = this._content.findIndex(function (c) {\n                  return c.dom === n\n                })\n                if (pos >= 0) {\n                  this.delete(pos)\n                } else {\n                  throw new Error('An unexpected condition occured (deleted node does not exist in the model)!')\n                }\n              })\n            }\n          })\n        })\n      }\n      this._domObserver = new MutationObserver(this._domObserverListener)\n      this._domObserver.observe(dom, { attributes: true, childList: true })\n      // In order to insert a new node, successor needs to be inserted\n      // when c.dom can be inserted, try to insert the predecessors too\n      var _tryInsertDom = (pos) => {\n        var c = this._content[pos]\n        var succ\n        if (pos + 1 < this._content.length) {\n          succ = this._content[pos + 1]\n          if (succ.dom == null) throw new Error('Unexpected behavior') // shouldn't happen anymore!\n        } else {\n          // pseudo successor\n          succ = {\n            dom: null\n          }\n        }\n        dom.insertBefore(c.dom, succ.dom)\n      }\n      this._tryInsertDom = _tryInsertDom\n      this.observe(event => {\n        mutualExclude(() => {\n          if (event.type === 'attributeChanged') {\n            dom.setAttribute(event.name, event.value)\n          } else if (event.type === 'attributeRemoved') {\n            dom.removeAttribute(event.name)\n          } else if (event.type === 'childInserted') {\n            if (event.nodes.length === 1 && event.nodes[0] instanceof YXml) {\n              // a new xml node was inserted.\n              // TODO: consider the case that nodes contains mixed text & types (currently not implemented in yjs)\n              var valId = this._content[event.index].id\n              if (event.nodes.length > 1) { throw new Error('This case is not handled, you\\'ll run into consistency issues. Contact the developer') }\n              var newNode = event.nodes[0].getDom()\n              // This is called async. So we have to compute the position again\n              // also mutual excluse this\n              var pos\n              if (event.index < this._content.length && Y.utils.compareIds(this._content[event.index].id, valId)) {\n                pos = event.index\n              } else {\n                pos = this._content.findIndex(function (c) {\n                  return Y.utils.compareIds(c.id, valId)\n                })\n              }\n              if (pos >= 0) {\n                this._content[pos].dom = newNode\n                _tryInsertDom(pos)\n              }\n            } else {\n              for (var i = event.nodes.length - 1; i >= 0; i--) {\n                var n = event.nodes[i]\n                var textNode = new Text(n)\n                this._content[event.index + i].dom = textNode\n                _tryInsertDom(event.index + i)\n              }\n            }\n          } else if (event.type === 'childRemoved') {\n            event._content.forEach(function (c) {\n              if (c.dom != null) {\n                c.dom.remove()\n              }\n            })\n          }\n        })\n      })\n      return dom\n    }\n\n    getDom () {\n      if (this.dom == null) {\n        var dom = document.createElement(this.tagname)\n        dom.__yxml = this\n        let attrs = this.getAttributes()\n        for (let key in attrs) {\n          dom.setAttribute(key, attrs[key])\n        }\n\n        for (var i = 0; i < this._content.length; i++) {\n          let c = this._content[i]\n          if (c.hasOwnProperty('val')) {\n            c.dom = new Text(c.val)\n          } else {\n            c.dom = this.os.getType(c.type).getDom()\n          }\n          dom.appendChild(c.dom)\n        }\n        this.dom = this._bindToDom(dom)\n      }\n      return this.dom\n    }\n\n    observe (f) {\n      function observeWrapper (event) {\n        if (event.type === 'insert') {\n          f({\n            type: 'childInserted',\n            index: event.index,\n            nodes: event.values\n          })\n        } else if (event.type === 'delete') {\n          if (event.index !== undefined) {\n            f({\n              type: 'childRemoved',\n              index: event.index,\n              values: event.values\n            })\n          } else {\n            f({\n              type: 'attributeRemoved',\n              name: event.name\n            })\n          }\n        } else if (event.type === 'update' || event.type === 'add') {\n          f({\n            type: 'attributeChanged',\n            name: event.name,\n            value: event.value\n          })\n        } else {\n          throw new Error('Unexpected event')\n        }\n      }\n      this._eventListenerHandler.addEventListener(observeWrapper)\n      return observeWrapper\n    }\n\n    unobserve (f) {\n      this._eventListenerHandler.removeEventListener(f)\n    }\n\n    * _changed (transaction, op) {\n      if (this._domObserver != null) {\n        this._domObserverListener(this._domObserver.takeRecords())\n      }\n      if (op.parentSub) {\n        yield * Y.Map.typeDefinition['class'].prototype._changed.apply(this, arguments)\n      } else {\n        yield * Y.Array.typeDefinition['class'].prototype._changed.apply(this, arguments)\n      }\n    }\n  }\n  Y.extend('Xml', new Y.utils.CustomTypeDefinition({\n    name: 'Xml',\n    class: YXml,\n    struct: 'Xml',\n    parseArguments: function (tagname) {\n      if (typeof tagname === 'string') {\n        return [this, tagname]\n      } else {\n        throw new Error('Y.Xml requires an argument which is a string!')\n      }\n    },\n    initType: function * YXmlInitializer (os, model, nodeName) {\n      // here begins the modified y-array init\n      var _content = []\n      var _types = []\n      yield * Y.Struct.Xml.map.call(this, model, function (op) {\n        if (op.hasOwnProperty('opContent')) {\n          _content.push({\n            id: op.id,\n            type: op.opContent\n          })\n          _types.push(op.opContent)\n        } else {\n          op.content.forEach(function (c, i) {\n            _content.push({\n              id: [op.id[0], op.id[1] + i],\n              val: op.content[i]\n            })\n          })\n        }\n      })\n      for (var i = 0; i < _types.length; i++) {\n        yield * os.initType.call(this, _types[i])\n      }\n      // here begins the modified y-map init\n      var contents = {}\n      var opContents = {}\n      var map = model.map\n      for (var name in map) {\n        var op = yield * this.getOperation(map[name])\n        if (op.deleted) continue\n        if (op.opContent != null) {\n          opContents[name] = op.opContent\n          yield * this.store.initType.call(this, op.opContent)\n        } else {\n          contents[name] = op.content[0]\n        }\n      }\n      return new YXml(os, model, _content, contents, opContents)\n    },\n    createType: function YXmlCreator (os, model, args) {\n      return new YXml(os, model, [], {}, {})\n    }\n  }))\n}\n\nif (typeof Y !== 'undefined') {\n  extendXml(Y)\n}\n"],"names":["yarrayEventHandler","op","struct","_content","some","c","Y","utils","compareIds","id","pos","left","findIndex","Error","values","length","hasOwnProperty","splice","opContent","type","os","getType","_parent","_model","contents","content","map","i","apply","concat","slice","bubbleEvent","inDeletionRange","delLength","target","val","ymapEventHandler","oldValue","key","parentSub","opContents","value","deleted","undefined","extendXml","YXml","model","arrayContent","_os","copyObject","nodeName","_domObserver","_dom","mapEventHandler","bind","arrayEventHandler","_eventListenerHandler","EventListenerHandler","disconnect","destroy","_nodeName","types","_types","Array","isArray","v","t","isTypeDefinition","class","push","typeDefinition","prototype","insert","call","delete","arguments","Map","set","get","keys","obj","forEach","dom","token","mutualExclude","records","takeRecords","_domObserverListener","e","_mutualExclude","mutation","name","attributeName","getAttribute","setAttribute","n","addedNodes","Text","textContent","remove","nextSibling","Element","Xml","removedNodes","MutationObserver","observe","attributes","childList","_tryInsertDom","succ","insertBefore","event","removeAttribute","nodes","valId","index","newNode","getDom","textNode","document","createElement","tagname","__yxml","attrs","getAttributes","appendChild","_bindToDom","f","observeWrapper","addEventListener","removeEventListener","transaction","_changed","CustomType","extend","CustomTypeDefinition","YXmlInitializer","Struct","initType","getOperation","store","YXmlCreator","args"],"mappings":"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"}